addpath( 'C:\Program Files\eeglab_current\eeglab15rc1\plugins\xdfimport1.13' );

IN.IN_PATH = 'C:\Data\Fujitsu Data Post-Testing\11012018\3209120218\'
IN.FILENAME = '3209120218_visual_arrest_2018-11-01_15-13-39_2.xdf'

IN.IN_PATH = 'C:\Data\Fujitsu Data Post-Testing\11022018\32960318\'
IN.FILENAME = '32960318_visual_arrest_2018-11-02_14-53-48_2.xdf'

[ALLEEG EEG CURRENTSET ALLCOM] = eeglab;

% % %
% load
fname = [IN.IN_PATH IN.FILENAME];
if (~isfile( fname ))
    disp( 'check filename' ); keyboard;
end

% this won't pass clock syncrho
%EEG = pop_loadxdf('3209120218_visual_arrest_2018-11-01_15-13-39_2.xdf' , 'streamtype', 'EEG', 'exclude_markerstreams', {}, 'HandleClockSynchronization', 0);
% this won't set all fields
%EEG = load_xdf_noClockSynchro('3209120218_visual_arrest_2018-11-01_15-13-39_2.xdf' , 'HandleClockSynchronization', 0);
% just right
EEG = eeg_load_xdf_noClockSynchro( fname , 'streamtype', 'EEG', 'exclude_markerstreams', {}, 'HandleClockSynchronization',0);

% epoch
EEG = pop_epoch( EEG, {  'eyes-closed-end'  }, [-10   0], 'epochinfo', 'yes');
[ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, 1,'overwrite','off','gui','off'); 
EEG = eeg_checkset( EEG );

% plot
EEG = eeg_checkset( EEG );
pop_eegplot( EEG, 1, 1, 1);

pop_topoplot_clip(EEG, 1, [-4000:1000:0] ,'EDF file epochs',[2 3] ,0,'electrodes','on');

% time-freq decomp. (param's from Golf data)
%EEG = eeg_checkset( EEG );
%figure; pop_newtimef( EEG, 1, 1, [-4000   999], [3         0.5] , 'topovec', 1, 'elocs', EEG.chanlocs, 'chaninfo', EEG.chaninfo, 'caption', 'F3', 'baseline',[0], 'plotphase', 'off', 'padratio', 1, 'winsize', 4096);

% topoplot
%EEG = eeg_checkset( EEG );
%figure; pop_topoplot(EEG, 1, [-10000:1000:0] ,'XDF file epochs',[2 3] ,0,'electrodes','on');